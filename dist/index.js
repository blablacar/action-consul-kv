(()=>{var e={9139:(e,t,r)=>{const{getValue:s,setValue:n,removeValue:o,lockKey:i}=r(8116);async function run(e){const t=e.getInput("state",{required:true});const r=e.getInput("key",{required:true});const s=e.getInput("value");const n=e.getInput("host",{required:true});const o=e.getInput("port",{required:true});const i=e.getInput("scheme",{required:true});const a=e.getInput("ca");const u=e.getInput("dc");const c=e.getInput("token");const l=e.getInput("recurse");const d=e.getInput("retrieve");const f=e.getInput("session");const p=e.getInput("cas");const h={host:n,port:o,secure:i==="https",ca:a!==""?a:null,dc:u!==""?u:null,token:c!==""?c:null};const y={key:r,value:s,recurse:l==="true",retrieve:d==="true",session:f,cas:p!==""?p:null};let m;try{m=await execute(t,h,y)}catch(t){e.setFailed(t.message)}output(e,m,"changed");output(e,m,"data");output(e,m,"flags");output(e,m,"index")}function output(e,t,r){if(!Object.prototype.hasOwnProperty.call(t,r)){return}e.setOutput(r,t[r]);e.info(`Set ${r}: ${JSON.stringify(t[r])}`)}async function execute(e,t,r){if(e==="acquire"){if(!r.session){throw new Error(`${e} of lock for ${r.key} requested but no session supplied`)}return await i(t,r.session,r.key,r.value,true,r.cas)}if(e==="release"){if(!r.session){throw new Error(`${e} of lock for ${r.key} requested but no session supplied`)}return await i(t,r.session,r.key,r.value,false,r.cas)}if(e==="present"){if(r.value===""){return await s(t,r.key,r.recurse)}return await n(t,r.key,r.value,r.retrieve)}if(e==="absent"){return await o(t,r.key,r.recurse)}throw new Error(`Unsupported state: ${e}`)}e.exports={execute:execute,run:run}},8116:(e,t,r)=>{const s=r(4519);function getConsul(e){const t={host:e.host||"localhost",port:parseInt(e.port,10)||8500,secure:e.secure||false,defaults:{recurse:e.recurse||false}};if(e.ca){t.ca=[e.ca]}if(e.dc){t.defaults.dc=e.dc}if(e.token){t.defaults.token=e.token}return new s(t)}async function hasValueChanged(e,t,r){const s=await e.kv.get(t);if(!s){return{changed:true}}return{changed:s.Value!==r,index:s.ModifyIndex}}function putValueByPath(e,t,r,s){const n=t.split(r);let o=e;for(const e of n.slice(0,-1)){if(!Object.prototype.hasOwnProperty.call(o,e)){o[e]={}}o=o[e]}o[n.slice(-1)]=s}async function getValue(e,t,r=false){const s=getConsul(e);const n=await s.kv.get({key:t,recurse:r});if(!n){return{changed:false}}if(Array.isArray(n)){let e=new RegExp(`^${t}/?`,"u");let r={};for(const t of n){const s=t.Key.replace(e,"");putValueByPath(r,s,"/",t.Value)}return{changed:false,data:r}}return{changed:false,data:n.Value,flags:n.Flags,index:n.ModifyIndex}}async function setValue(e,t,r,s=true){const n=getConsul(e);const{changed:o,index:i}=await hasValueChanged(n,t,r);if(o){await n.kv.set(t,r)}if(s){const e=await n.kv.get(t);return{changed:o,data:e.Value,flags:e.Flags,index:e.ModifyIndex}}const a={changed:o};if(i){a.index=i}return a}async function removeValue(e,t,r=false){const s=getConsul(e);const n={changed:false};if(r){const e=await s.kv.keys(t);n.changed=!!e.length}else{const e=await s.kv.get(t);if(e){n.changed=true;n.data=e.Value;n.index=e.ModifyIndex}}if(n.changed){await s.kv.del({key:t,recurse:r})}return n}async function lockKey(e,t,r,s,n,o=null){const i={key:r,value:s};const a=getConsul(e);let{changed:u,index:c}=await hasValueChanged(a,r,s);if(n){i.acquire=t}else{i.release=t}if(o!==null){i.cas=o}if(!n&&c){u=true}if(u){const e=await a.kv.set(i);u=n?!!e:true;if(n&&e&&!c){const e=await a.kv.get(r);if(e){c=e.ModifyIndex}}}if(c){return{changed:u,index:c}}return{changed:u}}e.exports={hasValueChanged:hasValueChanged,getValue:getValue,setValue:setValue,removeValue:removeValue,lockKey:lockKey}},7351:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){if(s===undefined)s=r;Object.defineProperty(e,s,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,s){if(s===undefined)s=r;e[s]=t[r]});var n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.hasOwnProperty.call(e,r))s(t,e,r);n(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.issue=t.issueCommand=void 0;const i=o(r(2087));const a=r(5278);function issueCommand(e,t,r){const s=new Command(e,t,r);process.stdout.write(s.toString()+i.EOL)}t.issueCommand=issueCommand;function issue(e,t=""){issueCommand(e,{},t)}t.issue=issue;const u="::";class Command{constructor(e,t,r){if(!e){e="missing.command"}this.command=e;this.properties=t;this.message=r}toString(){let e=u+this.command;if(this.properties&&Object.keys(this.properties).length>0){e+=" ";let t=true;for(const r in this.properties){if(this.properties.hasOwnProperty(r)){const s=this.properties[r];if(s){if(t){t=false}else{e+=","}e+=`${r}=${escapeProperty(s)}`}}}}e+=`${u}${escapeData(this.message)}`;return e}}function escapeData(e){return a.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function escapeProperty(e){return a.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}},2186:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){if(s===undefined)s=r;Object.defineProperty(e,s,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,s){if(s===undefined)s=r;e[s]=t[r]});var n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.hasOwnProperty.call(e,r))s(t,e,r);n(t,e);return t};var i=this&&this.__awaiter||function(e,t,r,s){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.getIDToken=t.getState=t.saveState=t.group=t.endGroup=t.startGroup=t.info=t.notice=t.warning=t.error=t.debug=t.isDebug=t.setFailed=t.setCommandEcho=t.setOutput=t.getBooleanInput=t.getMultilineInput=t.getInput=t.addPath=t.setSecret=t.exportVariable=t.ExitCode=void 0;const a=r(7351);const u=r(717);const c=r(5278);const l=o(r(2087));const d=o(r(5622));const f=r(5840);const p=r(8041);var h;(function(e){e[e["Success"]=0]="Success";e[e["Failure"]=1]="Failure"})(h=t.ExitCode||(t.ExitCode={}));function exportVariable(e,t){const r=c.toCommandValue(t);process.env[e]=r;const s=process.env["GITHUB_ENV"]||"";if(s){const t=`ghadelimiter_${f.v4()}`;if(e.includes(t)){throw new Error(`Unexpected input: name should not contain the delimiter "${t}"`)}if(r.includes(t)){throw new Error(`Unexpected input: value should not contain the delimiter "${t}"`)}const s=`${e}<<${t}${l.EOL}${r}${l.EOL}${t}`;u.issueCommand("ENV",s)}else{a.issueCommand("set-env",{name:e},r)}}t.exportVariable=exportVariable;function setSecret(e){a.issueCommand("add-mask",{},e)}t.setSecret=setSecret;function addPath(e){const t=process.env["GITHUB_PATH"]||"";if(t){u.issueCommand("PATH",e)}else{a.issueCommand("add-path",{},e)}process.env["PATH"]=`${e}${d.delimiter}${process.env["PATH"]}`}t.addPath=addPath;function getInput(e,t){const r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r){throw new Error(`Input required and not supplied: ${e}`)}if(t&&t.trimWhitespace===false){return r}return r.trim()}t.getInput=getInput;function getMultilineInput(e,t){const r=getInput(e,t).split("\n").filter((e=>e!==""));return r}t.getMultilineInput=getMultilineInput;function getBooleanInput(e,t){const r=["true","True","TRUE"];const s=["false","False","FALSE"];const n=getInput(e,t);if(r.includes(n))return true;if(s.includes(n))return false;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${e}\n`+`Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}t.getBooleanInput=getBooleanInput;function setOutput(e,t){process.stdout.write(l.EOL);a.issueCommand("set-output",{name:e},t)}t.setOutput=setOutput;function setCommandEcho(e){a.issue("echo",e?"on":"off")}t.setCommandEcho=setCommandEcho;function setFailed(e){process.exitCode=h.Failure;error(e)}t.setFailed=setFailed;function isDebug(){return process.env["RUNNER_DEBUG"]==="1"}t.isDebug=isDebug;function debug(e){a.issueCommand("debug",{},e)}t.debug=debug;function error(e,t={}){a.issueCommand("error",c.toCommandProperties(t),e instanceof Error?e.toString():e)}t.error=error;function warning(e,t={}){a.issueCommand("warning",c.toCommandProperties(t),e instanceof Error?e.toString():e)}t.warning=warning;function notice(e,t={}){a.issueCommand("notice",c.toCommandProperties(t),e instanceof Error?e.toString():e)}t.notice=notice;function info(e){process.stdout.write(e+l.EOL)}t.info=info;function startGroup(e){a.issue("group",e)}t.startGroup=startGroup;function endGroup(){a.issue("endgroup")}t.endGroup=endGroup;function group(e,t){return i(this,void 0,void 0,(function*(){startGroup(e);let r;try{r=yield t()}finally{endGroup()}return r}))}t.group=group;function saveState(e,t){a.issueCommand("save-state",{name:e},t)}t.saveState=saveState;function getState(e){return process.env[`STATE_${e}`]||""}t.getState=getState;function getIDToken(e){return i(this,void 0,void 0,(function*(){return yield p.OidcClient.getIDToken(e)}))}t.getIDToken=getIDToken;var y=r(1327);Object.defineProperty(t,"summary",{enumerable:true,get:function(){return y.summary}});var m=r(1327);Object.defineProperty(t,"markdownSummary",{enumerable:true,get:function(){return m.markdownSummary}});var g=r(2981);Object.defineProperty(t,"toPosixPath",{enumerable:true,get:function(){return g.toPosixPath}});Object.defineProperty(t,"toWin32Path",{enumerable:true,get:function(){return g.toWin32Path}});Object.defineProperty(t,"toPlatformPath",{enumerable:true,get:function(){return g.toPlatformPath}})},717:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){if(s===undefined)s=r;Object.defineProperty(e,s,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,s){if(s===undefined)s=r;e[s]=t[r]});var n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.hasOwnProperty.call(e,r))s(t,e,r);n(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.issueCommand=void 0;const i=o(r(5747));const a=o(r(2087));const u=r(5278);function issueCommand(e,t){const r=process.env[`GITHUB_${e}`];if(!r){throw new Error(`Unable to find environment variable for file command ${e}`)}if(!i.existsSync(r)){throw new Error(`Missing file at path: ${r}`)}i.appendFileSync(r,`${u.toCommandValue(t)}${a.EOL}`,{encoding:"utf8"})}t.issueCommand=issueCommand},8041:function(e,t,r){"use strict";var s=this&&this.__awaiter||function(e,t,r,s){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.OidcClient=void 0;const n=r(6255);const o=r(5526);const i=r(2186);class OidcClient{static createHttpClient(e=true,t=10){const r={allowRetries:e,maxRetries:t};return new n.HttpClient("actions/oidc-client",[new o.BearerCredentialHandler(OidcClient.getRequestToken())],r)}static getRequestToken(){const e=process.env["ACTIONS_ID_TOKEN_REQUEST_TOKEN"];if(!e){throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_TOKEN env variable")}return e}static getIDTokenUrl(){const e=process.env["ACTIONS_ID_TOKEN_REQUEST_URL"];if(!e){throw new Error("Unable to get ACTIONS_ID_TOKEN_REQUEST_URL env variable")}return e}static getCall(e){var t;return s(this,void 0,void 0,(function*(){const r=OidcClient.createHttpClient();const s=yield r.getJson(e).catch((e=>{throw new Error(`Failed to get ID Token. \n \n        Error Code : ${e.statusCode}\n \n        Error Message: ${e.result.message}`)}));const n=(t=s.result)===null||t===void 0?void 0:t.value;if(!n){throw new Error("Response json body do not have ID Token field")}return n}))}static getIDToken(e){return s(this,void 0,void 0,(function*(){try{let t=OidcClient.getIDTokenUrl();if(e){const r=encodeURIComponent(e);t=`${t}&audience=${r}`}i.debug(`ID token url is ${t}`);const r=yield OidcClient.getCall(t);i.setSecret(r);return r}catch(e){throw new Error(`Error message: ${e.message}`)}}))}}t.OidcClient=OidcClient},2981:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){if(s===undefined)s=r;Object.defineProperty(e,s,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,s){if(s===undefined)s=r;e[s]=t[r]});var n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.hasOwnProperty.call(e,r))s(t,e,r);n(t,e);return t};Object.defineProperty(t,"__esModule",{value:true});t.toPlatformPath=t.toWin32Path=t.toPosixPath=void 0;const i=o(r(5622));function toPosixPath(e){return e.replace(/[\\]/g,"/")}t.toPosixPath=toPosixPath;function toWin32Path(e){return e.replace(/[/]/g,"\\")}t.toWin32Path=toWin32Path;function toPlatformPath(e){return e.replace(/[/\\]/g,i.sep)}t.toPlatformPath=toPlatformPath},1327:function(e,t,r){"use strict";var s=this&&this.__awaiter||function(e,t,r,s){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.summary=t.markdownSummary=t.SUMMARY_DOCS_URL=t.SUMMARY_ENV_VAR=void 0;const n=r(2087);const o=r(5747);const{access:i,appendFile:a,writeFile:u}=o.promises;t.SUMMARY_ENV_VAR="GITHUB_STEP_SUMMARY";t.SUMMARY_DOCS_URL="https://docs.github.com/actions/using-workflows/workflow-commands-for-github-actions#adding-a-job-summary";class Summary{constructor(){this._buffer=""}filePath(){return s(this,void 0,void 0,(function*(){if(this._filePath){return this._filePath}const e=process.env[t.SUMMARY_ENV_VAR];if(!e){throw new Error(`Unable to find environment variable for $${t.SUMMARY_ENV_VAR}. Check if your runtime environment supports job summaries.`)}try{yield i(e,o.constants.R_OK|o.constants.W_OK)}catch(t){throw new Error(`Unable to access summary file: '${e}'. Check if the file has correct read/write permissions.`)}this._filePath=e;return this._filePath}))}wrap(e,t,r={}){const s=Object.entries(r).map((([e,t])=>` ${e}="${t}"`)).join("");if(!t){return`<${e}${s}>`}return`<${e}${s}>${t}</${e}>`}write(e){return s(this,void 0,void 0,(function*(){const t=!!(e===null||e===void 0?void 0:e.overwrite);const r=yield this.filePath();const s=t?u:a;yield s(r,this._buffer,{encoding:"utf8"});return this.emptyBuffer()}))}clear(){return s(this,void 0,void 0,(function*(){return this.emptyBuffer().write({overwrite:true})}))}stringify(){return this._buffer}isEmptyBuffer(){return this._buffer.length===0}emptyBuffer(){this._buffer="";return this}addRaw(e,t=false){this._buffer+=e;return t?this.addEOL():this}addEOL(){return this.addRaw(n.EOL)}addCodeBlock(e,t){const r=Object.assign({},t&&{lang:t});const s=this.wrap("pre",this.wrap("code",e),r);return this.addRaw(s).addEOL()}addList(e,t=false){const r=t?"ol":"ul";const s=e.map((e=>this.wrap("li",e))).join("");const n=this.wrap(r,s);return this.addRaw(n).addEOL()}addTable(e){const t=e.map((e=>{const t=e.map((e=>{if(typeof e==="string"){return this.wrap("td",e)}const{header:t,data:r,colspan:s,rowspan:n}=e;const o=t?"th":"td";const i=Object.assign(Object.assign({},s&&{colspan:s}),n&&{rowspan:n});return this.wrap(o,r,i)})).join("");return this.wrap("tr",t)})).join("");const r=this.wrap("table",t);return this.addRaw(r).addEOL()}addDetails(e,t){const r=this.wrap("details",this.wrap("summary",e)+t);return this.addRaw(r).addEOL()}addImage(e,t,r){const{width:s,height:n}=r||{};const o=Object.assign(Object.assign({},s&&{width:s}),n&&{height:n});const i=this.wrap("img",null,Object.assign({src:e,alt:t},o));return this.addRaw(i).addEOL()}addHeading(e,t){const r=`h${t}`;const s=["h1","h2","h3","h4","h5","h6"].includes(r)?r:"h1";const n=this.wrap(s,e);return this.addRaw(n).addEOL()}addSeparator(){const e=this.wrap("hr",null);return this.addRaw(e).addEOL()}addBreak(){const e=this.wrap("br",null);return this.addRaw(e).addEOL()}addQuote(e,t){const r=Object.assign({},t&&{cite:t});const s=this.wrap("blockquote",e,r);return this.addRaw(s).addEOL()}addLink(e,t){const r=this.wrap("a",e,{href:t});return this.addRaw(r).addEOL()}}const c=new Summary;t.markdownSummary=c;t.summary=c},5278:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.toCommandProperties=t.toCommandValue=void 0;function toCommandValue(e){if(e===null||e===undefined){return""}else if(typeof e==="string"||e instanceof String){return e}return JSON.stringify(e)}t.toCommandValue=toCommandValue;function toCommandProperties(e){if(!Object.keys(e).length){return{}}return{title:e.title,file:e.file,line:e.startLine,endLine:e.endLine,col:e.startColumn,endColumn:e.endColumn}}t.toCommandProperties=toCommandProperties},5526:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,s){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.PersonalAccessTokenCredentialHandler=t.BearerCredentialHandler=t.BasicCredentialHandler=void 0;class BasicCredentialHandler{constructor(e,t){this.username=e;this.password=t}prepareRequest(e){if(!e.headers){throw Error("The request has no headers")}e.headers["Authorization"]=`Basic ${Buffer.from(`${this.username}:${this.password}`).toString("base64")}`}canHandleAuthentication(){return false}handleAuthentication(){return r(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}}t.BasicCredentialHandler=BasicCredentialHandler;class BearerCredentialHandler{constructor(e){this.token=e}prepareRequest(e){if(!e.headers){throw Error("The request has no headers")}e.headers["Authorization"]=`Bearer ${this.token}`}canHandleAuthentication(){return false}handleAuthentication(){return r(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}}t.BearerCredentialHandler=BearerCredentialHandler;class PersonalAccessTokenCredentialHandler{constructor(e){this.token=e}prepareRequest(e){if(!e.headers){throw Error("The request has no headers")}e.headers["Authorization"]=`Basic ${Buffer.from(`PAT:${this.token}`).toString("base64")}`}canHandleAuthentication(){return false}handleAuthentication(){return r(this,void 0,void 0,(function*(){throw new Error("not implemented")}))}}t.PersonalAccessTokenCredentialHandler=PersonalAccessTokenCredentialHandler},6255:function(e,t,r){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,r,s){if(s===undefined)s=r;Object.defineProperty(e,s,{enumerable:true,get:function(){return t[r]}})}:function(e,t,r,s){if(s===undefined)s=r;e[s]=t[r]});var n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:true,value:t})}:function(e,t){e["default"]=t});var o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(r!=="default"&&Object.hasOwnProperty.call(e,r))s(t,e,r);n(t,e);return t};var i=this&&this.__awaiter||function(e,t,r,s){function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,n){function fulfilled(e){try{step(s.next(e))}catch(e){n(e)}}function rejected(e){try{step(s["throw"](e))}catch(e){n(e)}}function step(e){e.done?r(e.value):adopt(e.value).then(fulfilled,rejected)}step((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:true});t.HttpClient=t.isHttps=t.HttpClientResponse=t.HttpClientError=t.getProxyUrl=t.MediaTypes=t.Headers=t.HttpCodes=void 0;const a=o(r(8605));const u=o(r(7211));const c=o(r(9835));const l=o(r(4294));var d;(function(e){e[e["OK"]=200]="OK";e[e["MultipleChoices"]=300]="MultipleChoices";e[e["MovedPermanently"]=301]="MovedPermanently";e[e["ResourceMoved"]=302]="ResourceMoved";e[e["SeeOther"]=303]="SeeOther";e[e["NotModified"]=304]="NotModified";e[e["UseProxy"]=305]="UseProxy";e[e["SwitchProxy"]=306]="SwitchProxy";e[e["TemporaryRedirect"]=307]="TemporaryRedirect";e[e["PermanentRedirect"]=308]="PermanentRedirect";e[e["BadRequest"]=400]="BadRequest";e[e["Unauthorized"]=401]="Unauthorized";e[e["PaymentRequired"]=402]="PaymentRequired";e[e["Forbidden"]=403]="Forbidden";e[e["NotFound"]=404]="NotFound";e[e["MethodNotAllowed"]=405]="MethodNotAllowed";e[e["NotAcceptable"]=406]="NotAcceptable";e[e["ProxyAuthenticationRequired"]=407]="ProxyAuthenticationRequired";e[e["RequestTimeout"]=408]="RequestTimeout";e[e["Conflict"]=409]="Conflict";e[e["Gone"]=410]="Gone";e[e["TooManyRequests"]=429]="TooManyRequests";e[e["InternalServerError"]=500]="InternalServerError";e[e["NotImplemented"]=501]="NotImplemented";e[e["BadGateway"]=502]="BadGateway";e[e["ServiceUnavailable"]=503]="ServiceUnavailable";e[e["GatewayTimeout"]=504]="GatewayTimeout"})(d=t.HttpCodes||(t.HttpCodes={}));var f;(function(e){e["Accept"]="accept";e["ContentType"]="content-type"})(f=t.Headers||(t.Headers={}));var p;(function(e){e["ApplicationJson"]="application/json"})(p=t.MediaTypes||(t.MediaTypes={}));function getProxyUrl(e){const t=c.getProxyUrl(new URL(e));return t?t.href:""}t.getProxyUrl=getProxyUrl;const h=[d.MovedPermanently,d.ResourceMoved,d.SeeOther,d.TemporaryRedirect,d.PermanentRedirect];const y=[d.BadGateway,d.ServiceUnavailable,d.GatewayTimeout];const m=["OPTIONS","GET","DELETE","HEAD"];const g=10;const _=5;class HttpClientError extends Error{constructor(e,t){super(e);this.name="HttpClientError";this.statusCode=t;Object.setPrototypeOf(this,HttpClientError.prototype)}}t.HttpClientError=HttpClientError;class HttpClientResponse{constructor(e){this.message=e}readBody(){return i(this,void 0,void 0,(function*(){return new Promise((e=>i(this,void 0,void 0,(function*(){let t=Buffer.alloc(0);this.message.on("data",(e=>{t=Buffer.concat([t,e])}));this.message.on("end",(()=>{e(t.toString())}))}))))}))}}t.HttpClientResponse=HttpClientResponse;function isHttps(e){const t=new URL(e);return t.protocol==="https:"}t.isHttps=isHttps;class HttpClient{constructor(e,t,r){this._ignoreSslError=false;this._allowRedirects=true;this._allowRedirectDowngrade=false;this._maxRedirects=50;this._allowRetries=false;this._maxRetries=1;this._keepAlive=false;this._disposed=false;this.userAgent=e;this.handlers=t||[];this.requestOptions=r;if(r){if(r.ignoreSslError!=null){this._ignoreSslError=r.ignoreSslError}this._socketTimeout=r.socketTimeout;if(r.allowRedirects!=null){this._allowRedirects=r.allowRedirects}if(r.allowRedirectDowngrade!=null){this._allowRedirectDowngrade=r.allowRedirectDowngrade}if(r.maxRedirects!=null){this._maxRedirects=Math.max(r.maxRedirects,0)}if(r.keepAlive!=null){this._keepAlive=r.keepAlive}if(r.allowRetries!=null){this._allowRetries=r.allowRetries}if(r.maxRetries!=null){this._maxRetries=r.maxRetries}}}options(e,t){return i(this,void 0,void 0,(function*(){return this.request("OPTIONS",e,null,t||{})}))}get(e,t){return i(this,void 0,void 0,(function*(){return this.request("GET",e,null,t||{})}))}del(e,t){return i(this,void 0,void 0,(function*(){return this.request("DELETE",e,null,t||{})}))}post(e,t,r){return i(this,void 0,void 0,(function*(){return this.request("POST",e,t,r||{})}))}patch(e,t,r){return i(this,void 0,void 0,(function*(){return this.request("PATCH",e,t,r||{})}))}put(e,t,r){return i(this,void 0,void 0,(function*(){return this.request("PUT",e,t,r||{})}))}head(e,t){return i(this,void 0,void 0,(function*(){return this.request("HEAD",e,null,t||{})}))}sendStream(e,t,r,s){return i(this,void 0,void 0,(function*(){return this.request(e,t,r,s)}))}getJson(e,t={}){return i(this,void 0,void 0,(function*(){t[f.Accept]=this._getExistingOrDefaultHeader(t,f.Accept,p.ApplicationJson);const r=yield this.get(e,t);return this._processResponse(r,this.requestOptions)}))}postJson(e,t,r={}){return i(this,void 0,void 0,(function*(){const s=JSON.stringify(t,null,2);r[f.Accept]=this._getExistingOrDefaultHeader(r,f.Accept,p.ApplicationJson);r[f.ContentType]=this._getExistingOrDefaultHeader(r,f.ContentType,p.ApplicationJson);const n=yield this.post(e,s,r);return this._processResponse(n,this.requestOptions)}))}putJson(e,t,r={}){return i(this,void 0,void 0,(function*(){const s=JSON.stringify(t,null,2);r[f.Accept]=this._getExistingOrDefaultHeader(r,f.Accept,p.ApplicationJson);r[f.ContentType]=this._getExistingOrDefaultHeader(r,f.ContentType,p.ApplicationJson);const n=yield this.put(e,s,r);return this._processResponse(n,this.requestOptions)}))}patchJson(e,t,r={}){return i(this,void 0,void 0,(function*(){const s=JSON.stringify(t,null,2);r[f.Accept]=this._getExistingOrDefaultHeader(r,f.Accept,p.ApplicationJson);r[f.ContentType]=this._getExistingOrDefaultHeader(r,f.ContentType,p.ApplicationJson);const n=yield this.patch(e,s,r);return this._processResponse(n,this.requestOptions)}))}request(e,t,r,s){return i(this,void 0,void 0,(function*(){if(this._disposed){throw new Error("Client has already been disposed.")}const n=new URL(t);let o=this._prepareRequest(e,n,s);const i=this._allowRetries&&m.includes(e)?this._maxRetries+1:1;let a=0;let u;do{u=yield this.requestRaw(o,r);if(u&&u.message&&u.message.statusCode===d.Unauthorized){let e;for(const t of this.handlers){if(t.canHandleAuthentication(u)){e=t;break}}if(e){return e.handleAuthentication(this,o,r)}else{return u}}let t=this._maxRedirects;while(u.message.statusCode&&h.includes(u.message.statusCode)&&this._allowRedirects&&t>0){const i=u.message.headers["location"];if(!i){break}const a=new URL(i);if(n.protocol==="https:"&&n.protocol!==a.protocol&&!this._allowRedirectDowngrade){throw new Error("Redirect from HTTPS to HTTP protocol. This downgrade is not allowed for security reasons. If you want to allow this behavior, set the allowRedirectDowngrade option to true.")}yield u.readBody();if(a.hostname!==n.hostname){for(const e in s){if(e.toLowerCase()==="authorization"){delete s[e]}}}o=this._prepareRequest(e,a,s);u=yield this.requestRaw(o,r);t--}if(!u.message.statusCode||!y.includes(u.message.statusCode)){return u}a+=1;if(a<i){yield u.readBody();yield this._performExponentialBackoff(a)}}while(a<i);return u}))}dispose(){if(this._agent){this._agent.destroy()}this._disposed=true}requestRaw(e,t){return i(this,void 0,void 0,(function*(){return new Promise(((r,s)=>{function callbackForResult(e,t){if(e){s(e)}else if(!t){s(new Error("Unknown error"))}else{r(t)}}this.requestRawWithCallback(e,t,callbackForResult)}))}))}requestRawWithCallback(e,t,r){if(typeof t==="string"){if(!e.options.headers){e.options.headers={}}e.options.headers["Content-Length"]=Buffer.byteLength(t,"utf8")}let s=false;function handleResult(e,t){if(!s){s=true;r(e,t)}}const n=e.httpModule.request(e.options,(e=>{const t=new HttpClientResponse(e);handleResult(undefined,t)}));let o;n.on("socket",(e=>{o=e}));n.setTimeout(this._socketTimeout||3*6e4,(()=>{if(o){o.end()}handleResult(new Error(`Request timeout: ${e.options.path}`))}));n.on("error",(function(e){handleResult(e)}));if(t&&typeof t==="string"){n.write(t,"utf8")}if(t&&typeof t!=="string"){t.on("close",(function(){n.end()}));t.pipe(n)}else{n.end()}}getAgent(e){const t=new URL(e);return this._getAgent(t)}_prepareRequest(e,t,r){const s={};s.parsedUrl=t;const n=s.parsedUrl.protocol==="https:";s.httpModule=n?u:a;const o=n?443:80;s.options={};s.options.host=s.parsedUrl.hostname;s.options.port=s.parsedUrl.port?parseInt(s.parsedUrl.port):o;s.options.path=(s.parsedUrl.pathname||"")+(s.parsedUrl.search||"");s.options.method=e;s.options.headers=this._mergeHeaders(r);if(this.userAgent!=null){s.options.headers["user-agent"]=this.userAgent}s.options.agent=this._getAgent(s.parsedUrl);if(this.handlers){for(const e of this.handlers){e.prepareRequest(s.options)}}return s}_mergeHeaders(e){if(this.requestOptions&&this.requestOptions.headers){return Object.assign({},lowercaseKeys(this.requestOptions.headers),lowercaseKeys(e||{}))}return lowercaseKeys(e||{})}_getExistingOrDefaultHeader(e,t,r){let s;if(this.requestOptions&&this.requestOptions.headers){s=lowercaseKeys(this.requestOptions.headers)[t]}return e[t]||s||r}_getAgent(e){let t;const r=c.getProxyUrl(e);const s=r&&r.hostname;if(this._keepAlive&&s){t=this._proxyAgent}if(this._keepAlive&&!s){t=this._agent}if(t){return t}const n=e.protocol==="https:";let o=100;if(this.requestOptions){o=this.requestOptions.maxSockets||a.globalAgent.maxSockets}if(r&&r.hostname){const e={maxSockets:o,keepAlive:this._keepAlive,proxy:Object.assign(Object.assign({},(r.username||r.password)&&{proxyAuth:`${r.username}:${r.password}`}),{host:r.hostname,port:r.port})};let s;const i=r.protocol==="https:";if(n){s=i?l.httpsOverHttps:l.httpsOverHttp}else{s=i?l.httpOverHttps:l.httpOverHttp}t=s(e);this._proxyAgent=t}if(this._keepAlive&&!t){const e={keepAlive:this._keepAlive,maxSockets:o};t=n?new u.Agent(e):new a.Agent(e);this._agent=t}if(!t){t=n?u.globalAgent:a.globalAgent}if(n&&this._ignoreSslError){t.options=Object.assign(t.options||{},{rejectUnauthorized:false})}return t}_performExponentialBackoff(e){return i(this,void 0,void 0,(function*(){e=Math.min(g,e);const t=_*Math.pow(2,e);return new Promise((e=>setTimeout((()=>e()),t)))}))}_processResponse(e,t){return i(this,void 0,void 0,(function*(){return new Promise(((r,s)=>i(this,void 0,void 0,(function*(){const n=e.message.statusCode||0;const o={statusCode:n,result:null,headers:{}};if(n===d.NotFound){r(o)}function dateTimeDeserializer(e,t){if(typeof t==="string"){const e=new Date(t);if(!isNaN(e.valueOf())){return e}}return t}let i;let a;try{a=yield e.readBody();if(a&&a.length>0){if(t&&t.deserializeDates){i=JSON.parse(a,dateTimeDeserializer)}else{i=JSON.parse(a)}o.result=i}o.headers=e.message.headers}catch(e){}if(n>299){let e;if(i&&i.message){e=i.message}else if(a&&a.length>0){e=a}else{e=`Failed request: (${n})`}const t=new HttpClientError(e,n);t.result=o.result;s(t)}else{r(o)}}))))}))}}t.HttpClient=HttpClient;const lowercaseKeys=e=>Object.keys(e).reduce(((t,r)=>(t[r.toLowerCase()]=e[r],t)),{})},9835:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.checkBypass=t.getProxyUrl=void 0;function getProxyUrl(e){const t=e.protocol==="https:";if(checkBypass(e)){return undefined}const r=(()=>{if(t){return process.env["https_proxy"]||process.env["HTTPS_PROXY"]}else{return process.env["http_proxy"]||process.env["HTTP_PROXY"]}})();if(r){return new URL(r)}else{return undefined}}t.getProxyUrl=getProxyUrl;function checkBypass(e){if(!e.hostname){return false}const t=process.env["no_proxy"]||process.env["NO_PROXY"]||"";if(!t){return false}let r;if(e.port){r=Number(e.port)}else if(e.protocol==="http:"){r=80}else if(e.protocol==="https:"){r=443}const s=[e.hostname.toUpperCase()];if(typeof r==="number"){s.push(`${s[0]}:${r}`)}for(const e of t.split(",").map((e=>e.trim().toUpperCase())).filter((e=>e))){if(s.some((t=>t===e))){return true}}return false}t.checkBypass=checkBypass},8011:(e,t,r)=>{const s=r(2021).w;const n=r(9321);class Acl{constructor(e){this.consul=e;this.legacy=new Acl.Legacy(e)}async bootstrap(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"acl.bootstrap",path:"/acl/bootstrap",type:"json"};n.options(t,e);return await this.consul._put(t,n.body)}async replication(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"acl.replication",path:"/acl/replication",query:{}};n.options(t,e);return await this.consul._get(t,n.body)}}Acl.Legacy=s;t.W=Acl},2021:(e,t,r)=>{const s=r(447);const n=r(9321);class AclLegacy{constructor(e){this.consul=e}async create(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"acl.legacy.create",path:"/acl/create",query:{},type:"json",body:{}};if(e.name)t.body.Name=e.name;if(e.type)t.body.Type=e.type;if(e.rules)t.body.Rules=e.rules;n.options(t,e);return await this.consul._put(t,n.body)}async update(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"acl.legacy.update",path:"/acl/update",query:{},type:"json",body:{}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}t.body.ID=e.id;if(e.name)t.body.Name=e.name;if(e.type)t.body.Type=e.type;if(e.rules)t.body.Rules=e.rules;n.options(t,e);return await this.consul._put(t,n.empty)}async destroy(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"acl.legacy.destroy",path:"/acl/destroy/{id}",params:{id:e.id},query:{}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}n.options(t,e);return await this.consul._put(t,n.empty)}async info(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"acl.legacy.info",path:"/acl/info/{id}",params:{id:e.id},query:{}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}n.options(t,e);return await this.consul._get(t,n.bodyItem)}get(...e){return this.info(...e)}async clone(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"acl.legacy.clone",path:"/acl/clone/{id}",params:{id:e.id},query:{}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}n.options(t,e);return await this.consul._put(t,n.body)}async list(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"acl.legacy.list",path:"/acl/list",query:{}};n.options(t,e);return await this.consul._get(t,n.body)}}t.w=AclLegacy},9282:(e,t,r)=>{const s=r(2578).Q;const n=r(3752).R;const o=r(447);const i=r(9321);class Agent{constructor(e){this.consul=e;this.check=new Agent.Check(e);this.service=new Agent.Service(e)}checks(){return this.check.list.apply(this.check,arguments)}services(){return this.service.list.apply(this.service,arguments)}async members(e){e=i.normalizeKeys(e);e=i.defaults(e,this.consul._defaults);const t={name:"agent.members",path:"/agent/members",query:{}};i.options(t,e);return await this.consul._get(t,i.body)}async reload(e){e=i.normalizeKeys(e);e=i.defaults(e,this.consul._defaults);const t={name:"agent.reload",path:"/agent/reload"};i.options(t,e);return await this.consul._put(t,i.empty)}async self(e){e=i.normalizeKeys(e);e=i.defaults(e,this.consul._defaults);const t={name:"agent.self",path:"/agent/self"};i.options(t,e);return await this.consul._get(t,i.body)}async maintenance(e){if(typeof e==="boolean"){e={enable:e}}e=i.normalizeKeys(e);e=i.defaults(e,this.consul._defaults);const t={name:"agent.maintenance",path:"/agent/maintenance",query:{enable:e.enable}};if(typeof e.enable!=="boolean"){throw this.consul._err(o.Validation("enable required"),t)}if(e.reason)t.query.reason=e.reason;i.options(t,e);return await this.consul._put(t,i.empty)}async join(e){if(typeof e==="string"){e={address:e}}e=i.normalizeKeys(e);e=i.defaults(e,this.consul._defaults);const t={name:"agent.join",path:"/agent/join/{address}",params:{address:e.address}};if(!e.address){throw this.consul._err(o.Validation("address required"),t)}i.options(t,e);return await this.consul._put(t,i.empty)}async forceLeave(e){if(typeof e==="string"){e={node:e}}e=i.normalizeKeys(e);e=i.defaults(e,this.consul._defaults);const t={name:"agent.forceLeave",path:"/agent/force-leave/{node}",params:{node:e.node}};if(!e.node){throw this.consul._err(o.Validation("node required"),t)}i.options(t,e);return await this.consul._put(t,i.empty)}}Agent.Check=s;Agent.Service=n;t.P=Agent},2578:(e,t,r)=>{const s=r(447);const n=r(9321);class AgentCheck{constructor(e){this.consul=e}async list(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"agent.check.list",path:"/agent/checks"};n.options(t,e);return await this.consul._get(t,n.body)}async register(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"agent.check.register",path:"/agent/check/register",type:"json"};try{t.body=n.createCheck(e)}catch(e){throw this.consul._err(s.Validation(e.message),t)}n.options(t,e);return await this.consul._put(t,n.empty)}async deregister(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"agent.check.deregister",path:"/agent/check/deregister/{id}",params:{id:e.id}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}n.options(t,e);return await this.consul._put(t,n.empty)}async pass(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"agent.check.pass",path:"/agent/check/pass/{id}",params:{id:e.id},query:{}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}if(e.note)t.query.note=e.note;n.options(t,e);return await this.consul._put(t,n.empty)}async warn(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"agent.check.warn",path:"/agent/check/warn/{id}",params:{id:e.id},query:{}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}if(e.note)t.query.note=e.note;n.options(t,e);return await this.consul._put(t,n.empty)}async fail(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"agent.check.fail",path:"/agent/check/fail/{id}",params:{id:e.id},query:{}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}if(e.note)t.query.note=e.note;n.options(t,e);return await this.consul._put(t,n.empty)}}t.Q=AgentCheck},3752:(e,t,r)=>{const s=r(447);const n=r(9321);class AgentService{constructor(e){this.consul=e}async list(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"agent.service.list",path:"/agent/services"};n.options(t,e);return await this.consul._get(t,n.body)}async register(e){if(typeof e==="string"){e={name:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"agent.service.register",path:"/agent/service/register",type:"json",body:{}};if(!e.name){throw this.consul._err(s.Validation("name required"),t)}try{t.body=n.createService(e)}catch(e){throw this.consul._err(s.Validation(e.message),t)}n.options(t,e);return await this.consul._put(t,n.empty)}async deregister(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"agent.service.deregister",path:"/agent/service/deregister/{id}",params:{id:e.id}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}n.options(t,e);return await this.consul._put(t,n.empty)}async maintenance(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"agent.service.maintenance",path:"/agent/service/maintenance/{id}",params:{id:e.id},query:{enable:e.enable}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}if(typeof e.enable!=="boolean"){throw this.consul._err(s.Validation("enable required"),t)}if(e.reason)t.query.reason=e.reason;n.options(t,e);return await this.consul._put(t,n.empty)}}t.R=AgentService},3530:(e,t,r)=>{const s=r(1575).r;const n=r(1226).p;const o=r(9118).a;const i=r(9321);class Catalog{constructor(e){this.consul=e;this.connect=new Catalog.Connect(e);this.node=new Catalog.Node(e);this.service=new Catalog.Service(e)}async datacenters(e){e=i.normalizeKeys(e);e=i.defaults(e,this.consul._defaults);const t={name:"catalog.datacenters",path:"/catalog/datacenters"};i.options(t,e);return await this.consul._get(t,i.body)}nodes(...e){return this.node.list(...e)}services(...e){return this.service.list(...e)}}Catalog.Connect=s;Catalog.Node=n;Catalog.Service=o;t.g=Catalog},1575:(e,t,r)=>{const s=r(447);const n=r(9321);class CatalogConnect{constructor(e){this.consul=e}async nodes(e){if(typeof e==="string"){e={service:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"catalog.connect.nodes",path:"/catalog/connect/{service}",params:{service:e.service},query:{}};if(!e.service){throw this.consul._err(s.Validation("service required"),t)}n.options(t,e);return await this.consul._get(t,n.body)}}t.r=CatalogConnect},1226:(e,t,r)=>{const s=r(447);const n=r(9321);class CatalogNode{constructor(e){this.consul=e}async list(e){if(typeof e==="string"){e={dc:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"catalog.node.list",path:"/catalog/nodes"};n.options(t,e);return await this.consul._get(t,n.body)}async services(e){if(typeof e==="string"){e={node:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"catalog.node.services",path:"/catalog/node/{node}",params:{node:e.node}};if(!e.node){throw this.consul._err(s.Validation("node required"),t)}n.options(t,e);return await this.consul._get(t,n.body)}}t.p=CatalogNode},9118:(e,t,r)=>{const s=r(447);const n=r(9321);class CatalogService{constructor(e){this.consul=e}async list(e){if(typeof e==="string"){e={dc:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"catalog.service.list",path:"/catalog/services",query:{}};n.options(t,e);return await this.consul._get(t,n.body)}async nodes(e){if(typeof e==="string"){e={service:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"catalog.service.nodes",path:"/catalog/service/{service}",params:{service:e.service},query:{}};if(!e.service){throw this.consul._err(s.Validation("service required"),t)}if(e.tag)t.query.tag=e.tag;n.options(t,e);return await this.consul._get(t,n.body)}}t.a=CatalogService},4720:(e,t)=>{t.DEFAULT_OPTIONS=["consistent","dc","stale","timeout","token","wait","wan"];t.AGENT_STATUS=["none","alive","leaving","left","failed"];t.CHECK_STATE=["unknown","passing","warning","critical"];const r=t.DURATION_UNITS={ns:1};r.us=1e3*r.ns;r.ms=1e3*r.us;r.s=1e3*r.ms;r.m=60*r.s;r.h=60*r.m},2774:(e,t,r)=>{const s=r(3107);const n=r(8011).W;const o=r(9282).P;const i=r(3530).g;const a=r(5037).j;const u=r(191).S;const c=r(906).Kv;const l=r(1806).A;const d=r(3849).z;const f=r(3569).q;const p=r(9258).R;const h=r(4488).Y;const y=r(9321);class Consul extends s.Client{constructor(e){e=y.defaults({},e);if(!e.baseUrl){e.baseUrl=(e.secure?"https:":"http:")+"//"+(e.host||"127.0.0.1")+":"+(e.port||8500)+"/v1"}e.name="consul";e.type="json";let t;if(!e.agent){t=y.getAgent(e.baseUrl);if(t){e.agent=t}}let r;if(e.defaults){r=y.defaultCommonOptions(e.defaults)}delete e.defaults;super(e);if(r)this._defaults=r;this.acl=new Consul.Acl(this);this.agent=new Consul.Agent(this);this.catalog=new Consul.Catalog(this);this.event=new Consul.Event(this);this.health=new Consul.Health(this);this.kv=new Consul.Kv(this);this.query=new Consul.Query(this);this.session=new Consul.Session(this);this.status=new Consul.Status(this);this.transaction=new Consul.Transaction(this)}destroy(){if(this._opts.agent&&this._opts.agent.destroy){this._opts.agent.destroy()}}watch(e){return new Consul.Watch(this,e)}static parseQueryMeta(e){return y.parseQueryMeta(e)}}Consul.Acl=n;Consul.Agent=o;Consul.Catalog=i;Consul.Event=a;Consul.Health=u;Consul.Kv=c;Consul.Query=l;Consul.Session=d;Consul.Status=f;Consul.Transaction=h;Consul.Watch=p;t.Consul=Consul},447:(e,t)=>{"use strict";function create(e){const t=e instanceof Error?e:new Error(e?e:undefined);t.isConsul=true;return t}function validation(e){const t=create(e);t.isValidation=true;return t}t.Consul=create;t.Validation=validation},5037:(e,t,r)=>{const s=r(447);const n=r(9321);class Event{constructor(e){this.consul=e}async fire(e){let t;if(arguments.length===2){t={name:arguments[0],payload:arguments[1]}}else if(typeof e==="string"){t={name:e}}else{t=e}t=n.normalizeKeys(t);t=n.defaults(t,this.consul._defaults);const r={name:"event.fire",path:"/event/fire/{name}",params:{name:t.name},query:{}};if(!t.name){throw this.consul._err(s.Validation("name required"),r)}let o;if(t.hasOwnProperty("payload")){o=Buffer.isBuffer(t.payload);r.body=o?t.payload:Buffer.from(t.payload)}if(t.node)r.query.node=t.node;if(t.service)r.query.service=t.service;if(t.tag)r.query.tag=t.tag;n.options(r,t);return await this.consul._put(r,n.body).then((e=>{if(e.hasOwnProperty("Payload")){e.Payload=n.decode(e.Payload,{buffer:o})}return e}))}async list(e){if(typeof e==="string"){e={name:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"event.list",path:"/event/list",query:{}};if(e.name)t.query.name=e.name;n.options(t,e);return await this.consul._get(t,n.body).then((t=>{t.forEach((t=>{if(t.hasOwnProperty("Payload")){t.Payload=n.decode(t.Payload,e)}}));return t}))}}t.j=Event},191:(e,t,r)=>{const s=r(4720);const n=r(447);const o=r(9321);class Health{constructor(e){this.consul=e}async node(e){if(typeof e==="string"){e={node:e}}e=o.normalizeKeys(e);e=o.defaults(e,this.consul._defaults);const t={name:"health.node",path:"/health/node/{node}",params:{node:e.node}};if(!e.node){throw this.consul._err(n.Validation("node required"),t)}o.options(t,e);return await this.consul._get(t,o.body)}async checks(e){if(typeof e==="string"){e={service:e}}e=o.normalizeKeys(e);e=o.defaults(e,this.consul._defaults);const t={name:"health.checks",path:"/health/checks/{service}",params:{service:e.service}};if(!e.service){throw this.consul._err(n.Validation("service required"),t)}o.options(t,e);return await this.consul._get(t,o.body)}async service(e){if(typeof e==="string"){e={service:e}}e=o.normalizeKeys(e);e=o.defaults(e,this.consul._defaults);const t={name:"health.service",path:"/health/service/{service}",params:{service:e.service},query:{}};if(!e.service){throw this.consul._err(n.Validation("service required"),t)}if(e.tag)t.query.tag=e.tag;if(e.passing)t.query.passing="true";o.options(t,e);return await this.consul._get(t,o.body)}async state(e){if(typeof e==="string"){e={state:e}}e=o.normalizeKeys(e);e=o.defaults(e,this.consul._defaults);const t={name:"health.state",path:"/health/state/{state}",params:{state:e.state}};if(!e.state){throw this.consul._err(n.Validation("state required"),t)}if(e.state!=="any"&&s.CHECK_STATE.indexOf(e.state)<0){throw this.consul._err(n.Validation("state invalid: "+e.state),t)}o.options(t,e);return await this.consul._get(t,o.body)}}t.S=Health},4519:(e,t,r)=>{const{Consul:s}=r(2774);e.exports=s},906:(e,t,r)=>{const s=r(447);const n=r(9321);class Kv{constructor(e){this.consul=e}async get(e){if(typeof e==="string"){e={key:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"kv.get",path:"/kv/{key}",params:{key:e.key||""},query:{}};if(e.recurse)t.query.recurse="true";if(e.raw){t.query.raw="true";t.buffer=true}n.options(t,e);return await this.consul._get(t,(function(t,r){const s=t.res;if(s&&s.statusCode===404){return r(false,undefined,n.responseResult(t))}if(t.err){n.applyErrorResponse(t);return r(t.err)}if(e.raw){return r(false,undefined,n.responseResult(t,s.body))}if(s.body&&Array.isArray(s.body)&&s.body.length){s.body.forEach((t=>{if(t.hasOwnProperty("Value")){t.Value=n.decode(t.Value,e)}}))}else{return r(false,undefined,n.responseResult(t))}if(!e.recurse){return r(false,undefined,n.responseResult(t,s.body[0]))}r(false,undefined,n.responseResult(t,s.body))}))}async keys(e){if(typeof e==="string"){e={key:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"kv.keys",path:"/kv/{key}",params:{key:e.key||""},query:{keys:true}};if(e.separator)t.query.separator=e.separator;n.options(t,e);return await this.consul._get(t,n.body)}async set(e){let t;switch(arguments.length){case 3:t=arguments[2];t.key=arguments[0];t.value=arguments[1];break;case 2:t={key:arguments[0],value:arguments[1]};break;default:t=e}t=n.normalizeKeys(t);t=n.defaults(t,this.consul._defaults);const r={name:"kv.set",path:"/kv/{key}",params:{key:t.key},query:{},type:"text",body:t.value||""};if(!t.key){throw this.consul._err(s.Validation("key required"),r)}if(!t.hasOwnProperty("value")){throw this.consul._err(s.Validation("value required"),r)}if(t.hasOwnProperty("cas"))r.query.cas=t.cas;if(t.hasOwnProperty("flags"))r.query.flags=t.flags;if(t.hasOwnProperty("acquire"))r.query.acquire=t.acquire;if(t.hasOwnProperty("release"))r.query.release=t.release;n.options(r,t);return await this.consul._put(r,n.body)}async del(e){if(typeof e==="string"){e={key:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"kv.del",path:"/kv/{key}",params:{key:e.key||""},query:{}};if(e.recurse)t.query.recurse="true";if(e.hasOwnProperty("cas"))t.query.cas=e.cas;n.options(t,e);return await this.consul._delete(t,n.body)}delete(){return this.del.apply(this,arguments)}}t.Kv=Kv},1806:(e,t,r)=>{const s=r(447);const n=r(9321);class Query{constructor(e){this.consul=e}async list(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"query.list",path:"/query"};n.options(t,e);return await this.consul._get(t,n.body)}async create(e){if(typeof e==="string"){e={service:{service:e}}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"query.create",path:"/query",query:{},type:"json"};this._params(t,e);if(!t.body.Service||!t.body.Service.Service){throw this.consul._err(s.Validation("service required"),t)}n.options(t,e,{near:true});return await this.consul._post(t,n.body)}async get(e){if(typeof e==="string"){e={query:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"query.get",path:"/query/{query}",params:{query:e.query},query:{}};if(!e.query){throw this.consul._err(s.Validation("query required"),t)}n.options(t,e);return await this.consul._get(t,n.bodyItem)}async update(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"query.update",path:"/query/{query}",params:{query:e.query},query:{},type:"json"};if(!e.query){throw this.consul._err(s.Validation("query required"),t)}this._params(t,e);if(!t.body.Service||!t.body.Service.Service){throw this.consul._err(s.Validation("service required"),t)}n.options(t,e,{near:true});return await this.consul._put(t,n.empty)}async destroy(e){if(typeof e==="string"){e={query:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"query.destroy",path:"/query/{query}",params:{query:e.query},query:{}};if(!e.query){throw this.consul._err(s.Validation("query required"),t)}n.options(t,e);return await this.consul._delete(t,n.empty)}async execute(e){if(typeof e==="string"){e={query:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"query.execute",path:"/query/{query}/execute",params:{query:e.query},query:{}};if(!e.query){throw this.consul._err(s.Validation("query required"),t)}n.options(t,e);return await this.consul._get(t,n.body)}async explain(e){if(typeof e==="string"){e={query:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"query.explain",path:"/query/{query}/explain",params:{query:e.query},query:{}};if(!e.query){throw this.consul._err(s.Validation("query required"),t)}n.options(t,e);return await this.consul._get(t,n.bodyItem)}_params(e,t){const r=e.body||{};if(t.name)r.Name=t.name;if(t.session)r.Session=t.session;if(t.token){r.Token=t.token;delete t.token}if(t.near)r.Near=t.near;if(t.template){const e=n.normalizeKeys(t.template);if(e.type||e.regexp){r.Template={};if(e.type)r.Template.Type=e.type;if(e.regexp)r.Template.Regexp=e.regexp}}if(t.service){const e=n.normalizeKeys(t.service);r.Service={};if(e.service)r.Service.Service=e.service;if(e.failover){const t=n.normalizeKeys(e.failover);if(typeof t.nearestn==="number"||t.datacenters){r.Service.Failover={};if(typeof t.nearestn==="number"){r.Service.Failover.NearestN=t.nearestn}if(t.datacenters){r.Service.Failover.Datacenters=t.datacenters}}}if(typeof e.onlypassing==="boolean"){r.Service.OnlyPassing=e.onlypassing}if(e.tags)r.Service.Tags=e.tags}if(t.dns){const e=n.normalizeKeys(t.dns);if(e.ttl)r.DNS={TTL:e.ttl}}e.body=r}}t.A=Query},3849:(e,t,r)=>{const s=r(447);const n=r(9321);class Session{constructor(e){this.consul=e}async create(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"session.create",path:"/session/create",query:{},type:"json",body:{}};if(e.lockdelay)t.body.LockDelay=e.lockdelay;if(e.name)t.body.Name=e.name;if(e.node)t.body.Node=e.node;if(e.checks)t.body.Checks=e.checks;if(e.behavior)t.body.Behavior=e.behavior;if(e.ttl)t.body.TTL=e.ttl;n.options(t,e);return await this.consul._put(t,n.body)}async destroy(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"session.destroy",path:"/session/destroy/{id}",params:{id:e.id},query:{}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}n.options(t,e);return await this.consul._put(t,n.empty)}async info(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"session.info",path:"/session/info/{id}",params:{id:e.id},query:{}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}n.options(t,e);return await this.consul._get(t,n.bodyItem)}get(e){return this.info(e)}async node(e){if(typeof e==="string"){e={node:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"session.node",path:"/session/node/{node}",params:{node:e.node}};if(!e.node){throw this.consul._err(s.Validation("node required"),t)}n.options(t,e);return await this.consul._get(t,n.body)}async list(e){e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"session.list",path:"/session/list"};n.options(t,e);return await this.consul._get(t,n.body)}async renew(e){if(typeof e==="string"){e={id:e}}e=n.normalizeKeys(e);e=n.defaults(e,this.consul._defaults);const t={name:"session.renew",path:"/session/renew/{id}",params:{id:e.id}};if(!e.id){throw this.consul._err(s.Validation("id required"),t)}n.options(t,e);return await this.consul._put(t,n.body)}}t.z=Session},3569:(e,t,r)=>{const s=r(9321);class Status{constructor(e){this.consul=e}async leader(e){e=s.normalizeKeys(e);e=s.defaults(e,this.consul._defaults);const t={name:"status.leader",path:"/status/leader"};s.options(t,e);return await this.consul._get(t,s.body)}async peers(e){e=s.normalizeKeys(e);e=s.defaults(e,this.consul._defaults);const t={name:"status.peers",path:"/status/peers"};s.options(t,e);return await this.consul._get(t,s.body)}}t.q=Status},4488:(e,t,r)=>{const s=r(447);const n=r(9321);class Transaction{constructor(e){this.consul=e}async create(e){let t;switch(arguments.length){case 2:t=n.clone(arguments[1]);t.operations=e;break;case 1:t={operations:e};break;default:throw this.consul._err(s.Validation("a list of operations are required as first arguments"),{name:"Transaction.create"})}t=n.normalizeKeys(t);t=n.defaults(t,this.consul._defaults);const r={name:"Transaction.create",path:"/txn",params:{},query:{},type:"json",body:t.operations};if(!(Array.isArray(t.operations)&&t.operations.length>0)){throw this.consul._err(s.Validation("operations must be an array with at least one item"),r)}n.options(r,t);return await this.consul._put(r,n.body)}}t.Y=Transaction},9321:(e,t,r)=>{"use strict";const s=r(8605);const n=r(7211);const o=r(4720);function getAgent(e){if(!e)return;let t;if(typeof e==="string"){t=!!e.match(/^https:/i)}else if(e.protocol){t=e.protocol==="https:"}else{return}const r=t?n.Agent:s.Agent;return new r({keepAlive:true})}function responseResult(e,...t){if(e.ctx&&e.ctx.includeResponse){return[e.res,...t]}else{return t[0]}}function applyErrorResponse(e){if(e.err&&e.ctx&&e.ctx.includeResponse){e.err.response=e.res}}function body(e,t){if(e.err){applyErrorResponse(e);return t(false,e.err)}t(false,undefined,responseResult(e,e.res.body))}function bodyItem(e,t){if(e.err){applyErrorResponse(e);return t(false,e.err)}if(e.res.body&&e.res.body.length){return t(false,undefined,responseResult(e,e.res.body[0]))}t(false,undefined,responseResult(e))}function empty(e,t){if(e.err){applyErrorResponse(e);return t(false,e.err)}t(false,undefined,responseResult(e))}function normalizeKeys(e){const t={};if(e){for(const r in e){if(e.hasOwnProperty(r)){t[r.replace(/_/g,"").toLowerCase()]=e[r]}}}return t}function defaults(e){if(!e)e={};let t;for(let r=0;r<arguments.length;r++){t=arguments[r];for(const r in t){if(t.hasOwnProperty(r)&&!e.hasOwnProperty(r)){e[r]=t[r]}}}return e}function parseDuration(e){if(typeof e==="number")return e/1e6;if(typeof e!=="string")return;let t;let r=e.match(/^(\d*\.?\d*)$/);if(r){t=parseFloat(r[1]);if(!isNaN(t))return t/1e6}r=e.match(/^([\d.]*)(ns|us|ms|s|m|h)$/);if(!r)return;t=parseFloat(r[1]);if(isNaN(t))return;return t*o.DURATION_UNITS[r[2]]/1e6}function options(e,t,r){if(!t)t={};if(!r)r={};if(!e.headers)e.headers={};if(t.hasOwnProperty("token")&&!r.token)e.headers["x-consul-token"]=t.token;if(!e.query)e.query={};if(t.dc&&!r.dc)e.query.dc=t.dc;if(t.wan&&!r.wan)e.query.wan="1";if(t.consistent&&!r.consistent){e.query.consistent="1"}else if(t.stale&&!r.stale){e.query.stale="1"}if(t.hasOwnProperty("index")&&!r.index)e.query.index=t.index;if(t.hasOwnProperty("wait")&&!r.wait)e.query.wait=t.wait;if(t.hasOwnProperty("near")&&!r.near)e.query.near=t.near;if(t.hasOwnProperty("node-meta")&&!r["node-meta"]){e.query["node-meta"]=t["node-meta"]}if(t.hasOwnProperty("filter")&&!r.filter)e.query.filter=t.filter;if(t.hasOwnProperty("ctx")&&!r.ctx)e.ctx=t.ctx;if(t.hasOwnProperty("timeout")&&!r.timeout){if(typeof t.timeout==="string"){e.timeout=parseDuration(t.timeout)}else{e.timeout=t.timeout}}}function defaultCommonOptions(e){e=normalizeKeys(e);let t;o.DEFAULT_OPTIONS.forEach((function(r){if(!e.hasOwnProperty(r))return;if(!t)t={};t[r]=e[r]}));return t}function decode(e,t){if(typeof e!=="string")return e;e=Buffer.from(e,"base64");if(!t||!t.buffer)e=e.toString();return e}function clone(e){const t={};for(const r in e){if(e.hasOwnProperty(r)){t[r]=e[r]}}return t}function setTimeoutContext(e,t,r){let s;const cancel=function(){clearTimeout(s)};s=setTimeout((function(){t.removeListener("cancel",cancel);e()}),r);t.once("cancel",cancel)}function _createTaggedAddress(e){const t={};if(e.hasOwnProperty("address"))t.Address=e.address;if(e.hasOwnProperty("port"))t.Port=e.port;return t}function _createTaggedAddresses(e){const t={};if(e.lan){t.lan=_createTaggedAddress(normalizeKeys(e.lan))}if(e.wan){t.wan=_createTaggedAddress(normalizeKeys(e.wan))}return t}function _createServiceCheck(e){const t={};if((e.grpc||e.http||e.tcp||e.args||e.script)&&e.interval){if(e.grpc){t.GRPC=e.grpc;if(e.hasOwnProperty("grpcusetls"))t.GRPCUseTLS=e.grpcusetls}else if(e.http){t.HTTP=e.http;if(e.hasOwnProperty("tlsskipverify"))t.TLSSkipVerify=e.tlsskipverify}else if(e.tcp){t.TCP=e.tcp}else{if(e.args){t.Args=e.args}else{t.Script=e.script}if(e.hasOwnProperty("dockercontainerid"))t.DockerContainerID=e.dockercontainerid;if(e.hasOwnProperty("shell"))t.Shell=e.shell}t.Interval=e.interval;if(e.hasOwnProperty("timeout"))t.Timeout=e.timeout}else if(e.ttl){t.TTL=e.ttl}else if(e.aliasnode||e.aliasservice){if(e.hasOwnProperty("aliasnode"))t.AliasNode=e.aliasnode;if(e.hasOwnProperty("aliasservice"))t.AliasService=e.aliasservice}else{throw new Error("args/grpc/http/tcp and interval, ttl, or aliasnode/aliasservice")}if(e.hasOwnProperty("notes"))t.Notes=e.notes;if(e.hasOwnProperty("status"))t.Status=e.status;if(e.hasOwnProperty("deregistercriticalserviceafter")){t.DeregisterCriticalServiceAfter=e.deregistercriticalserviceafter}if(e.hasOwnProperty("failuresbeforecritical")){t.FailuresBeforeCritical=e.failuresbeforecritical}if(e.hasOwnProperty("successbeforepassing")){t.SuccessBeforePassing=e.successbeforepassing}return t}function createServiceCheck(e){return _createServiceCheck(normalizeKeys(e))}function _createServiceProxy(e){const t={};if(e.destinationservicename){t.DestinationServiceName=e.destinationservicename}else{throw Error("destinationservicename required")}if(e.destinationserviceid)t.DestinationServiceID=e.destinationserviceid;if(e.localserviceaddress)t.LocalServiceAddress=e.localserviceaddress;if(e.hasOwnProperty("localserviceport"))t.LocalServicePort=e.localserviceport;if(e.config)t.Config=e.config;if(e.upstreams)t.Upstreams=e.upstreams;if(e.meshgateway)t.MeshGateway=e.meshgateway;if(e.expose)t.Expose=e.expose;return t}function _createService(e,t){const r={};if(e.name)r.Name=e.name;if(e.id)r.ID=e.id;if(e.tags)r.Tags=e.tags;if(e.meta)r.Meta=e.meta;if(e.hasOwnProperty("address"))r.Address=e.address;if(e.hasOwnProperty("port"))r.Port=e.port;if(Array.isArray(e.checks)){r.Checks=e.checks.map(createServiceCheck)}else if(e.check){r.Check=createServiceCheck(e.check)}if(e.connect){const s=normalizeKeys(e.connect);r.Connect={};if(s.hasOwnProperty("native"))r.Connect.Native=s.native;if(s.proxy){r.Connect.Proxy=_createServiceProxy(normalizeKeys(s.proxy))}if(s.sidecarservice){if(!t){r.Connect.SidecarService=_createService(normalizeKeys(s.sidecarservice),true)}else{throw new Error("sidecarservice cannot be nested")}}}if(e.proxy){r.Proxy=_createServiceProxy(normalizeKeys(e.proxy))}if(e.taggedaddresses){r.TaggedAddresses=_createTaggedAddresses(normalizeKeys(e.taggedaddresses))}return r}function createService(e){return _createService(normalizeKeys(e))}function createCheck(e){e=normalizeKeys(e);const t=_createServiceCheck(e);if(e.name){t.Name=e.name}else{throw new Error("name required")}if(e.hasOwnProperty("id"))t.ID=e.id;if(e.hasOwnProperty("serviceid"))t.ServiceID=e.serviceid;return t}function hasIndexChanged(e,t){if(typeof e!=="string"||!e)return false;if(typeof t!=="string"||!t)return true;return e!==t}function parseQueryMeta(e){const t={};if(e&&e.headers){if(e.headers["x-consul-index"]){t.LastIndex=e.headers["x-consul-index"]}if(e.headers["x-consul-lastcontact"]){t.LastContact=parseInt(e.headers["x-consul-lastcontact"],10)}if(e.headers["x-consul-knownleader"]){t.KnownLeader=e.headers["x-consul-knownleader"]==="true"}if(e.headers["x-consul-translate-addresses"]){t.AddressTranslationEnabled=e.headers["x-consul-translate-addresses"]==="true"}}return t}t.getAgent=getAgent;t.responseResult=responseResult;t.applyErrorResponse=applyErrorResponse;t.body=body;t.bodyItem=bodyItem;t.decode=decode;t.empty=empty;t.normalizeKeys=normalizeKeys;t.defaults=defaults;t.options=options;t.defaultCommonOptions=defaultCommonOptions;t.clone=clone;t.parseDuration=parseDuration;t.setTimeoutContext=setTimeoutContext;t.createServiceCheck=createServiceCheck;t.createService=createService;t.createCheck=createCheck;t.hasIndexChanged=hasIndexChanged;t.parseQueryMeta=parseQueryMeta},9258:(e,t,r)=>{const s=r(8614);const n=r(447);const o=r(9321);class Watch extends s.EventEmitter{constructor(e,t){super();this.consul=e;t=o.normalizeKeys(t);let r=o.normalizeKeys(t.options||{});r=o.defaults(r,e._defaults);r.wait=r.wait||"30s";r.index=r.index||"0";if(typeof r.timeout!=="string"&&typeof r.timeout!=="number"){const e=o.parseDuration(r.wait);r.timeout=Math.ceil(e+Math.max(e*.1,500))}let s=100;if(t.hasOwnProperty("backofffactor")&&typeof t.backofffactor==="number"){s=t.backofffactor}let i=30*1e3;if(t.hasOwnProperty("backoffmax")&&typeof t.backoffmax==="number"){i=t.backoffmax}let a=-1;if(t.hasOwnProperty("maxattempts")&&typeof t.maxattempts==="number"){a=t.maxattempts}this._context={consul:e};this._options=r;this._attempts=0;this._maxAttempts=a;this._backoffMax=i;this._backoffFactor=s;this._method=t.method;this.includeResponse=true;if(typeof t.method!=="function"){throw n.Validation("method required")}process.nextTick((()=>this._run()))}isRunning(){return!this._end}updateTime(){return this._updateTime}end(){if(this._end)return;this._end=true;this.emit("cancel");this.emit("end")}_wait(){this._attempts+=1;if(this._attemptsMaxed){return this._backoffMax}const e=Math.pow(2,this._attempts)*this._backoffFactor;if(e<this._backoffMax){return e}else{this._attemptsMaxed=true;return this._backoffMax}}_err(e,t){if(this._end)return;this.emit("error",e,t);if(e&&e.isValidation)return this.end();if(t&&t.statusCode===400)return this.end();if(this._maxAttempts>=0&&this._attempts>=this._maxAttempts)return this.end();o.setTimeoutContext((()=>{this._run()}),this,this._wait())}_run(){if(this._end)return;const e=o.clone(this._options);e.ctx=this;this._method.call(this._context,e).then((([e,t])=>{this._updateTime=+new Date;this._attempts=0;this._attemptsMaxed=false;const r=e.headers["x-consul-index"];if(r===undefined){return this._err(n.Validation("Watch not supported"),e)}if(o.hasIndexChanged(r,this._options.index)){this._options.index=r;this.emit("change",t,e)}process.nextTick((()=>{this._run()}))})).catch((e=>{this._err(e,e.response)}))}}t.R=Watch},494:(e,t,r)=>{"use strict";const s=r(8614);const n=r(8605);const o=r(7211);const i=r(1669);const a=r(8761);const u=r(4893);const c=r(5408);const l=r(7603);class Client extends s.EventEmitter{constructor(e){super();e=e||{};if(typeof e==="string"||e instanceof URL){e={baseUrl:e}}else{e=l.merge(e)}if(!e.baseUrl){throw new u.ValidationError("baseUrl required")}if(!(e.baseUrl instanceof URL)){if(typeof e.baseUrl!=="string"){throw new u.ValidationError("baseUrl must be a string: "+e.baseUrl)}e.baseUrl=new URL(e.baseUrl)}const t={};t.protocol=e.baseUrl.protocol;t.hostname=e.baseUrl.hostname;if(e.baseUrl.username)t.auth=e.baseUrl.username;if(e.baseUrl.password){t.auth=(t.auth||"")+":"+e.baseUrl.password}if(e.baseUrl.port)t.port=e.baseUrl.port;if(!e.baseUrl.pathname||e.baseUrl.pathname==="/"){t.path=""}else if(e.baseUrl.pathname[e.baseUrl.pathname.length-1]==="/"){throw new u.ValidationError("baseUrl must not end with a forward slash")}else{t.path=e.baseUrl.pathname}e.baseUrl=t;e.headers=l.mergeHeaders(e.headers);if(e.tags){if(Array.isArray(e.tags)){e.tags=e.tags.slice(0)}else{throw new u.ValidationError("tags must be an array")}}else{e.tags=[]}if(e.name&&!~e.tags.indexOf(e.name)){e.tags.push(e.name)}e.encoders=l.merge(a.ENCODERS,e.encoders);e.decoders=l.merge(a.DECODERS,e.decoders);this._opts=e;this._exts={}}_err(e,t){if(!e)return e;if(!(e instanceof Error))e=new Error(e);if(t&&t.name){e.message=i.format("%s: %s",t.name,e.message)}if(this._opts.name){e.message=i.format("%s: %s",this._opts.name,e.message)}return e}_ext(e,t){if(!e||typeof e!=="string"){throw this._err(new u.ValidationError("extension eventName required"))}if(typeof t!=="function"){throw this._err(new u.ValidationError("extension callback required"))}if(!this._exts[e])this._exts[e]=[];this._exts[e].push(t)}_plugin(e,t){if(!e){throw this._err(new u.ValidationError("plugin required"))}if(typeof e.register!=="function"){throw this._err(new u.ValidationError("plugin must have register function"))}const r=e.register.attributes;if(!r){throw this._err(new u.ValidationError("plugin attributes required"))}if(!r.name){throw this._err(new u.ValidationError("plugin attributes name required"))}if(!r.version){throw this._err(new u.ValidationError("plugin attributes version required"))}return e.register(this,t||{})}_log(e,t){return this.emit("log",e,t)}_encode(e,t){if(!this._opts.encoders[e]){throw new u.CodecError("unknown encoder: "+e)}try{return this._opts.encoders[e](t)}catch(t){t.message="encode ("+e+") failed: "+t.message;throw new u.CodecError(t)}}_decode(e,t){if(!this._opts.decoders[e]){throw new u.CodecError("unknown decoder: "+e)}try{return this._opts.decoders[e](t)}catch(t){t.message="decode ("+e+") failed: "+t.message;throw new u.CodecError(t)}}__push(e,t){if(this._exts[t]){e._stack.push.apply(e._stack,this._exts[t])}if(e.opts&&e.opts.exts&&e.opts.exts[t]){if(Array.isArray(e.opts.exts[t])){e._stack.push.apply(e._stack,e.opts.exts[t])}else{e._stack.push(e.opts.exts[t])}}}_request(e){if(!e)e={};const t={opts:e,state:{}};if(e.ctx instanceof s.EventEmitter){t.ctx=e.ctx}e.tags=(e.tags||[]).concat(this._opts.tags);if(e.name&&!~e.tags.indexOf(e.name)){e.tags.push(e.name)}if(!e.headers)e.headers={};if(!e.params)e.params={};if(!e.query)e.query={};t.retry=()=>{if(t._retryable===false){throw new u.ValidationError("request is not retryable")}this._log(["papi","request","retry"].concat(t.opts.tags));delete t.body;delete t.err;delete t.req;delete t.res;delete t.transport;this.__pipeline(t)};t._stack=[];this.__push(t,"onCreate");t._stack.push(this.__create);this.__push(t,"onRequest");t._stack.push(this.__execute);this.__push(t,"onResponse");t._stack.push.apply(t._stack,Array.prototype.slice.call(arguments,1));return new Promise(((e,r)=>{t._resolve=e;t._reject=r;this.__pipeline(t)}))}__pipeline(e){const t=this;let r=0;function next(s,n,o){if(s)return e._reject(t._err(s,e.opts));if(s===false){if(n instanceof Error){return e._reject(n)}else if(!n&&o){n=o}return e._resolve(n)}const i=e._stack[r++];if(i){i.call(t,e,next)}else if(e.err){e._reject(t._err(e.err,e.opts))}else{e._resolve(e.res)}}next()}__create(e,t){const r=e.opts;let s=r.path;if(typeof s!=="string"){return t(new u.ValidationError("path required"))}const i=l.mergeHeaders(this._opts.headers,r.headers);try{s=s.replace(/\{(\w+)\}/g,((e,t)=>{if(!r.params.hasOwnProperty(t)){throw new u.ValidationError("missing param: "+t)}let s=r.params[t]||"";return s.encode===false&&s.toString?s.toString():encodeURIComponent(s)}))}catch(e){return t(e)}if(!l.isEmpty(r.query)){try{s+="?"+this._encode("application/x-www-form-urlencoded",r.query).toString()}catch(e){return t(e)}}if(r.body!==undefined){let s=a.MIME_ALIAS[r.type]||i["content-type"]||a.MIME_ALIAS[this._opts.type];let n=typeof r.body==="function";if(n){try{e.body=r.body()}catch(e){return t(e)}}else{e.body=r.body}const o=Buffer.isBuffer(e.body);const c=l.isReadableStream(e.body);if(!o&&!c&&!s){return t(new u.ValidationError("type required"))}if(!o&&!c){if(this._opts.encoders[s]){try{e.body=this._encode(s,e.body)}catch(e){return t(e)}}else{return t(new u.CodecError("type is unknown: "+s))}}if(!i["content-type"]&&s){i["content-type"]=s+"; charset="+a.CHARSET}if(c){if(!n)e._retryable=false}else{i["content-length"]=e.body.length}}else if(!~a.EXCLUDE_CONTENT_LENGTH.indexOf((r.method||"").toUpperCase())){i["content-length"]=0}if(r.pipe){const s=typeof r.pipe==="function";if(s){try{e.pipe=r.pipe()}catch(e){return t(e)}}else{e.pipe=r.pipe;e._retryable=false}if(!l.isWritableStream(e.pipe)){return t(new u.ValidationError("pipe must be a writable stream"))}}e.req=l.merge(l.pick(this._opts,a.CLIENT_OPTIONS),this._opts.socketPath?l.pick(this._opts.baseUrl,"auth","path"):l.pick(this._opts.baseUrl,"auth","hostname","port","path"),l.pick(r,a.REQUEST_OPTIONS),{headers:i});e.req.path+=s;if(this._opts.baseUrl.protocol==="https:"){e.transport=o;if(!e.req.port&&!this._opts.socketPath){e.req.port=443}}else{e.transport=n;if(!e.req.port&&!this._opts.socketPath){e.req.port=80}}t()}__execute(e,t){if(e.ctx){if(e.ctx.canceled===true){return t(new u.ValidationError("ctx already canceled"))}else if(e.ctx.finished===true){return t(new u.ValidationError("ctx already finished"))}}let r=false;const s=e.opts;let o;let i;let a=s.hasOwnProperty("timeout")?s.timeout:this._opts.timeout;this._log(["papi","request"].concat(s.tags),e.req);const d=e.transport.request(e.req);const f=d.getHeader("user-agent");if(f===undefined){d.setHeader("user-agent","papi/"+c.version)}else if(f===null){d.removeHeader("user-agent")}d.on("error",(n=>{this._log(["papi","request","error"].concat(s.tags),n);if(r)return;r=true;if(o)e.ctx.removeListener("cancel",o);if(i)clearTimeout(i);e.err=n;t()}));if(e.ctx){o=()=>{d.abort();d.emit("error",new u.AbortError("request aborted"))};e.ctx.once("cancel",o)}if(a&&a>0){i=setTimeout((()=>{d.emit("timeout");d.abort()}),a);d.setTimeout(a)}d.on("timeout",(e=>{this._log(["papi","request","error","timeout"].concat(s.tags));if(e){e=new u.TimeoutError(e)}else{e=new u.TimeoutError("request timed out ("+a+"ms)")}d.emit("error",e)}));d.on("response",(a=>{let c=[];let l=0;this._log(["papi","response"].concat(s.tags),{method:s.method,path:d.path,statusCode:a.statusCode,headers:a.headers,remoteAddress:a.socket&&a.socket.remoteAddress,remotePort:a.socket&&a.socket.remotePort});e.res=a;if(e.pipe){a.pipe(e.pipe)}else{a.on("data",(e=>{c.push(e);l+=e.length}))}a.on("end",(()=>{if(r)return;r=true;if(o)e.ctx.removeListener("cancel",o);if(i)clearTimeout(i);let d;if(l){a.body=Buffer.concat(c,l);if(!s.buffer){d=(a.headers["content-type"]||"").split(";")[0].trim();if(this._opts.decoders[d]){try{a.body=this._decode(d,a.body)}catch(r){e.err=r;return t()}}}}if(Math.floor(a.statusCode/100)!==2){let t;if(a.body&&d==="text/plain"&&a.body.length<80){t=a.body}if(!t){if(n.STATUS_CODES[a.statusCode]){t=n.STATUS_CODES[a.statusCode].toLowerCase()}else{t="request failed: "+a.statusCode}}e.err=new u.ResponseError(t,a)}t()}))}));if(l.isReadableStream(e.body)){e.body.pipe(d)}else{d.end(e.body)}}__shortcut(e,t){let r;let s=t[0];if(typeof s==="string"){r=Array.prototype.slice.call(t);r[0]=s={path:s}}else if(!s){r=Array.prototype.slice.call(t);r[0]=s={}}else{r=t}s.method=e;return this._request.apply(this,r)}_options(){return this.__shortcut("OPTIONS",arguments)}_get(){return this.__shortcut("GET",arguments)}_head(){return this.__shortcut("HEAD",arguments)}_post(){return this.__shortcut("POST",arguments)}_put(){return this.__shortcut("PUT",arguments)}_delete(){return this.__shortcut("DELETE",arguments)}_del(){return this.__shortcut("DELETE",arguments)}_patch(){return this.__shortcut("PATCH",arguments)}}t.K=Client},6034:(e,t,r)=>{"use strict";const s=r(1191);const n={encode:e=>Buffer.from(e,"utf8"),decode:e=>Buffer.isBuffer(e)?e.toString():e};const o={encode:e=>n.encode(JSON.stringify(e)),decode:e=>JSON.parse(n.decode(e))};const i={encode:e=>n.encode(s.stringify(e)),decode:e=>s.parse(n.decode(e))};t.json=o;t.form=i;t.text=n},8761:(e,t,r)=>{"use strict";const s=r(6034);t.CHARSET="utf-8";t.ENCODERS=Object.freeze({"application/json":s.json.encode,"application/x-www-form-urlencoded":s.form.encode,"text/plain":s.text.encode});t.DECODERS=Object.freeze({"application/json":s.json.decode,"application/x-www-form-urlencoded":s.form.decode,"text/html":s.text.decode,"text/json":s.json.decode,"text/plain":s.text.decode});t.MIME_ALIAS=Object.freeze({form:"application/x-www-form-urlencoded",json:"application/json",qs:"application/x-www-form-urlencoded",querystring:"application/x-www-form-urlencoded",text:"text/plain"});t.EXCLUDE_CONTENT_LENGTH=Object.freeze(["GET","HEAD","OPTIONS"]);t.CLIENT_OPTIONS=Object.freeze(["agent","createConnection","family","hints","localAddress","localPort","lookup","maxHeaderSize","setHost","socketPath","ca","cert","ciphers","clientCertEngine","crl","dhparam","ecdhCurve","honorCipherOrder","key","passphrase","pfx","rejectUnauthorized","secureOptions","secureProtocol","servername","sessionIdContext"]);t.REQUEST_OPTIONS=Object.freeze(t.CLIENT_OPTIONS.concat(["method"]))},4893:(e,t)=>{"use strict";class PapiError extends Error{constructor(e){if(e instanceof Error){super(e.message);this.cause=e}else{super(e)}this.isPapi=true}}class CodecError extends PapiError{constructor(e){super(e);this.isCodec=true}}class ResponseError extends PapiError{constructor(e,t){super(e);this.isResponse=true;this.response=t}get statusCode(){return this.response.statusCode}}class AbortError extends PapiError{constructor(e){super(e);this.isAbort=true}}class TimeoutError extends PapiError{constructor(e){super(e);this.isTimeout=true}}class ValidationError extends PapiError{constructor(e){super(e);this.isValidation=true}}t.PapiError=PapiError;t.CodecError=CodecError;t.ResponseError=ResponseError;t.AbortError=AbortError;t.TimeoutError=TimeoutError;t.ValidationError=ValidationError},3107:(e,t,r)=>{"use strict";const s=r(494).K;const n=r(6034);const o=r(4893);const i=r(8171);const a=r(3105);t.Client=s;t.PapiError=o.PapiError;t.CodecError=o.CodecError;t.ResponseError=o.ResponseError;t.AbortError=o.AbortError;t.TimeoutError=o.TimeoutError;t.ValidationError=o.ValidationError;t.request=i.request;t.get=i.method("GET");t.head=i.method("HEAD");t.post=i.method("POST");t.put=i.method("PUT");t.del=t.delete=i.method("DELETE");t.patch=i.method("PATCH");t.codecs=n;t.tools=a},8171:(e,t,r)=>{"use strict";const s=r(494).K;const n=r(4893);async function request(e){if(typeof e==="string"||e instanceof URL){arguments[0]=e={method:"get",url:e}}else{e=e||{}}if(!e.url){throw new n.ValidationError("url required")}let t;if(typeof e.url==="string"){t=new URL(e.url)}else if(e.url instanceof URL){t=e.url}else{throw new n.ValidationError("url must be a string")}e.path=t.pathname.replace("%7B","{").replace("%7D","}");t=new URL("/",t);const r=new s({baseUrl:t});delete e.url;return await r._request.apply(r,arguments)}function method(e){return async function(t){if(typeof t==="string"||t instanceof URL){arguments[0]=t={url:t}}else{t=t||{}}t.method=e;return await request.apply(null,arguments)}}t.method=method;t.request=request},3105:(e,t,r)=>{"use strict";const s=r(1669);function walk(e,t,r){switch(arguments.length){case 1:t=e.name;r={name:t};break;case 2:r={name:t};break;case 3:break;default:throw new Error("invalid arguments")}Object.getOwnPropertyNames(e.prototype).forEach((t=>{if(t==="constructor")return;const s=e.prototype[t];if(!t.match(/^[a-z]+/))return;if(!r.methods)r.methods={};r.methods[t]={name:t,value:s};const n=e.meta||{};r.methods[t].type=n[t]&&n[t].type||"promise"}));Object.keys(e).forEach((t=>{const s=e[t];if(!t.match(/^[A-Z]+/))return;if(!r.objects)r.objects={};r.objects[t]={name:t,value:s};walk(s,t,r.objects[t])}));return r}function callbackify(e){if(!e)throw new Error("client required");const patch=(e,t)=>{Object.keys(t.methods).forEach((r=>{const n=t.methods[r];const o=e[n.name];if(n.type==="promise"){e[n.name]=s.callbackify(o)}}));if(t.objects){Object.keys(t.objects).forEach((r=>{const s=r[0].toLowerCase()+r.slice(1);patch(e[s],t.objects[r])}))}};patch(e,walk(e.constructor))}t.callbackify=callbackify;t.walk=walk},7603:(e,t)=>{"use strict";function isEmpty(e){if(!e)return true;for(let t in e){if(e.hasOwnProperty(t))return false}return true}function isStream(e){return e!==null&&typeof e==="object"&&typeof e.pipe==="function"}function isReadableStream(e){return isStream(e)&&e.readable!==false}function isWritableStream(e){return isStream(e)&&e.writable!==false}function merge(){const e={};for(let t=0;t<arguments.length;t++){const r=arguments[t];if(r!=null){for(const t in r){if(Object.prototype.hasOwnProperty.call(r,t)){e[t]=r[t]}}}}return e}function mergeHeaders(){const e={};for(let t=0;t<arguments.length;t++){const r=arguments[t];if(r!=null){for(const t in r){if(Object.prototype.hasOwnProperty.call(r,t)){e[t.toLowerCase()]=r[t]}}}}return e}function pick(e){let t=arguments;let r=1;if(t.length===2&&Array.isArray(t[1])){t=t[1];r=0}const s={};for(let n=r;n<t.length;n++){const r=t[n];if(e.hasOwnProperty(r)){s[r]=e[r]}}return s}t.isEmpty=isEmpty;t.isReadableStream=isReadableStream;t.isWritableStream=isWritableStream;t.merge=merge;t.mergeHeaders=mergeHeaders;t.pick=pick},4294:(e,t,r)=>{e.exports=r(4219)},4219:(e,t,r)=>{"use strict";var s=r(1631);var n=r(4016);var o=r(8605);var i=r(7211);var a=r(8614);var u=r(2357);var c=r(1669);t.httpOverHttp=httpOverHttp;t.httpsOverHttp=httpsOverHttp;t.httpOverHttps=httpOverHttps;t.httpsOverHttps=httpsOverHttps;function httpOverHttp(e){var t=new TunnelingAgent(e);t.request=o.request;return t}function httpsOverHttp(e){var t=new TunnelingAgent(e);t.request=o.request;t.createSocket=createSecureSocket;t.defaultPort=443;return t}function httpOverHttps(e){var t=new TunnelingAgent(e);t.request=i.request;return t}function httpsOverHttps(e){var t=new TunnelingAgent(e);t.request=i.request;t.createSocket=createSecureSocket;t.defaultPort=443;return t}function TunnelingAgent(e){var t=this;t.options=e||{};t.proxyOptions=t.options.proxy||{};t.maxSockets=t.options.maxSockets||o.Agent.defaultMaxSockets;t.requests=[];t.sockets=[];t.on("free",(function onFree(e,r,s,n){var o=toOptions(r,s,n);for(var i=0,a=t.requests.length;i<a;++i){var u=t.requests[i];if(u.host===o.host&&u.port===o.port){t.requests.splice(i,1);u.request.onSocket(e);return}}e.destroy();t.removeSocket(e)}))}c.inherits(TunnelingAgent,a.EventEmitter);TunnelingAgent.prototype.addRequest=function addRequest(e,t,r,s){var n=this;var o=mergeOptions({request:e},n.options,toOptions(t,r,s));if(n.sockets.length>=this.maxSockets){n.requests.push(o);return}n.createSocket(o,(function(t){t.on("free",onFree);t.on("close",onCloseOrRemove);t.on("agentRemove",onCloseOrRemove);e.onSocket(t);function onFree(){n.emit("free",t,o)}function onCloseOrRemove(e){n.removeSocket(t);t.removeListener("free",onFree);t.removeListener("close",onCloseOrRemove);t.removeListener("agentRemove",onCloseOrRemove)}}))};TunnelingAgent.prototype.createSocket=function createSocket(e,t){var r=this;var s={};r.sockets.push(s);var n=mergeOptions({},r.proxyOptions,{method:"CONNECT",path:e.host+":"+e.port,agent:false,headers:{host:e.host+":"+e.port}});if(e.localAddress){n.localAddress=e.localAddress}if(n.proxyAuth){n.headers=n.headers||{};n.headers["Proxy-Authorization"]="Basic "+new Buffer(n.proxyAuth).toString("base64")}l("making CONNECT request");var o=r.request(n);o.useChunkedEncodingByDefault=false;o.once("response",onResponse);o.once("upgrade",onUpgrade);o.once("connect",onConnect);o.once("error",onError);o.end();function onResponse(e){e.upgrade=true}function onUpgrade(e,t,r){process.nextTick((function(){onConnect(e,t,r)}))}function onConnect(n,i,a){o.removeAllListeners();i.removeAllListeners();if(n.statusCode!==200){l("tunneling socket could not be established, statusCode=%d",n.statusCode);i.destroy();var u=new Error("tunneling socket could not be established, "+"statusCode="+n.statusCode);u.code="ECONNRESET";e.request.emit("error",u);r.removeSocket(s);return}if(a.length>0){l("got illegal response body from proxy");i.destroy();var u=new Error("got illegal response body from proxy");u.code="ECONNRESET";e.request.emit("error",u);r.removeSocket(s);return}l("tunneling connection has established");r.sockets[r.sockets.indexOf(s)]=i;return t(i)}function onError(t){o.removeAllListeners();l("tunneling socket could not be established, cause=%s\n",t.message,t.stack);var n=new Error("tunneling socket could not be established, "+"cause="+t.message);n.code="ECONNRESET";e.request.emit("error",n);r.removeSocket(s)}};TunnelingAgent.prototype.removeSocket=function removeSocket(e){var t=this.sockets.indexOf(e);if(t===-1){return}this.sockets.splice(t,1);var r=this.requests.shift();if(r){this.createSocket(r,(function(e){r.request.onSocket(e)}))}};function createSecureSocket(e,t){var r=this;TunnelingAgent.prototype.createSocket.call(r,e,(function(s){var o=e.request.getHeader("host");var i=mergeOptions({},r.options,{socket:s,servername:o?o.replace(/:.*$/,""):e.host});var a=n.connect(0,i);r.sockets[r.sockets.indexOf(s)]=a;t(a)}))}function toOptions(e,t,r){if(typeof e==="string"){return{host:e,port:t,localAddress:r}}return e}function mergeOptions(e){for(var t=1,r=arguments.length;t<r;++t){var s=arguments[t];if(typeof s==="object"){var n=Object.keys(s);for(var o=0,i=n.length;o<i;++o){var a=n[o];if(s[a]!==undefined){e[a]=s[a]}}}}return e}var l;if(process.env.NODE_DEBUG&&/\btunnel\b/.test(process.env.NODE_DEBUG)){l=function(){var e=Array.prototype.slice.call(arguments);if(typeof e[0]==="string"){e[0]="TUNNEL: "+e[0]}else{e.unshift("TUNNEL:")}console.error.apply(console,e)}}else{l=function(){}}t.debug=l},5840:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});Object.defineProperty(t,"v1",{enumerable:true,get:function(){return s.default}});Object.defineProperty(t,"v3",{enumerable:true,get:function(){return n.default}});Object.defineProperty(t,"v4",{enumerable:true,get:function(){return o.default}});Object.defineProperty(t,"v5",{enumerable:true,get:function(){return i.default}});Object.defineProperty(t,"NIL",{enumerable:true,get:function(){return a.default}});Object.defineProperty(t,"version",{enumerable:true,get:function(){return u.default}});Object.defineProperty(t,"validate",{enumerable:true,get:function(){return c.default}});Object.defineProperty(t,"stringify",{enumerable:true,get:function(){return l.default}});Object.defineProperty(t,"parse",{enumerable:true,get:function(){return d.default}});var s=_interopRequireDefault(r(8628));var n=_interopRequireDefault(r(6409));var o=_interopRequireDefault(r(5122));var i=_interopRequireDefault(r(9120));var a=_interopRequireDefault(r(5332));var u=_interopRequireDefault(r(1595));var c=_interopRequireDefault(r(6900));var l=_interopRequireDefault(r(8950));var d=_interopRequireDefault(r(2746));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}},4569:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=_interopRequireDefault(r(6417));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function md5(e){if(Array.isArray(e)){e=Buffer.from(e)}else if(typeof e==="string"){e=Buffer.from(e,"utf8")}return s.default.createHash("md5").update(e).digest()}var n=md5;t.default=n},5332:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r="00000000-0000-0000-0000-000000000000";t.default=r},2746:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=_interopRequireDefault(r(6900));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function parse(e){if(!(0,s.default)(e)){throw TypeError("Invalid UUID")}let t;const r=new Uint8Array(16);r[0]=(t=parseInt(e.slice(0,8),16))>>>24;r[1]=t>>>16&255;r[2]=t>>>8&255;r[3]=t&255;r[4]=(t=parseInt(e.slice(9,13),16))>>>8;r[5]=t&255;r[6]=(t=parseInt(e.slice(14,18),16))>>>8;r[7]=t&255;r[8]=(t=parseInt(e.slice(19,23),16))>>>8;r[9]=t&255;r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255;r[11]=t/4294967296&255;r[12]=t>>>24&255;r[13]=t>>>16&255;r[14]=t>>>8&255;r[15]=t&255;return r}var n=parse;t.default=n},814:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;t.default=r},807:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=rng;var s=_interopRequireDefault(r(6417));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const n=new Uint8Array(256);let o=n.length;function rng(){if(o>n.length-16){s.default.randomFillSync(n);o=0}return n.slice(o,o+=16)}},5274:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=_interopRequireDefault(r(6417));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function sha1(e){if(Array.isArray(e)){e=Buffer.from(e)}else if(typeof e==="string"){e=Buffer.from(e,"utf8")}return s.default.createHash("sha1").update(e).digest()}var n=sha1;t.default=n},8950:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=_interopRequireDefault(r(6900));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const n=[];for(let e=0;e<256;++e){n.push((e+256).toString(16).substr(1))}function stringify(e,t=0){const r=(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase();if(!(0,s.default)(r)){throw TypeError("Stringified UUID is invalid")}return r}var o=stringify;t.default=o},8628:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=_interopRequireDefault(r(807));var n=_interopRequireDefault(r(8950));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}let o;let i;let a=0;let u=0;function v1(e,t,r){let c=t&&r||0;const l=t||new Array(16);e=e||{};let d=e.node||o;let f=e.clockseq!==undefined?e.clockseq:i;if(d==null||f==null){const t=e.random||(e.rng||s.default)();if(d==null){d=o=[t[0]|1,t[1],t[2],t[3],t[4],t[5]]}if(f==null){f=i=(t[6]<<8|t[7])&16383}}let p=e.msecs!==undefined?e.msecs:Date.now();let h=e.nsecs!==undefined?e.nsecs:u+1;const y=p-a+(h-u)/1e4;if(y<0&&e.clockseq===undefined){f=f+1&16383}if((y<0||p>a)&&e.nsecs===undefined){h=0}if(h>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}a=p;u=h;i=f;p+=122192928e5;const m=((p&268435455)*1e4+h)%4294967296;l[c++]=m>>>24&255;l[c++]=m>>>16&255;l[c++]=m>>>8&255;l[c++]=m&255;const g=p/4294967296*1e4&268435455;l[c++]=g>>>8&255;l[c++]=g&255;l[c++]=g>>>24&15|16;l[c++]=g>>>16&255;l[c++]=f>>>8|128;l[c++]=f&255;for(let e=0;e<6;++e){l[c+e]=d[e]}return t||(0,n.default)(l)}var c=v1;t.default=c},6409:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=_interopRequireDefault(r(5998));var n=_interopRequireDefault(r(4569));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const o=(0,s.default)("v3",48,n.default);var i=o;t.default=i},5998:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=_default;t.URL=t.DNS=void 0;var s=_interopRequireDefault(r(8950));var n=_interopRequireDefault(r(2746));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function stringToBytes(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r){t.push(e.charCodeAt(r))}return t}const o="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=o;const i="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=i;function _default(e,t,r){function generateUUID(e,o,i,a){if(typeof e==="string"){e=stringToBytes(e)}if(typeof o==="string"){o=(0,n.default)(o)}if(o.length!==16){throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)")}let u=new Uint8Array(16+e.length);u.set(o);u.set(e,o.length);u=r(u);u[6]=u[6]&15|t;u[8]=u[8]&63|128;if(i){a=a||0;for(let e=0;e<16;++e){i[a+e]=u[e]}return i}return(0,s.default)(u)}try{generateUUID.name=e}catch(e){}generateUUID.DNS=o;generateUUID.URL=i;return generateUUID}},5122:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=_interopRequireDefault(r(807));var n=_interopRequireDefault(r(8950));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function v4(e,t,r){e=e||{};const o=e.random||(e.rng||s.default)();o[6]=o[6]&15|64;o[8]=o[8]&63|128;if(t){r=r||0;for(let e=0;e<16;++e){t[r+e]=o[e]}return t}return(0,n.default)(o)}var o=v4;t.default=o},9120:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=_interopRequireDefault(r(5998));var n=_interopRequireDefault(r(5274));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const o=(0,s.default)("v5",80,n.default);var i=o;t.default=i},6900:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=_interopRequireDefault(r(814));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function validate(e){return typeof e==="string"&&s.default.test(e)}var n=validate;t.default=n},1595:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var s=_interopRequireDefault(r(6900));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function version(e){if(!(0,s.default)(e)){throw TypeError("Invalid UUID")}return parseInt(e.substr(14,1),16)}var n=version;t.default=n},5408:e=>{"use strict";e.exports=JSON.parse('{"name":"papi","version":"1.1.0","description":"Build HTTP API clients","main":"lib","devDependencies":{"debug":"^4.1.1","jscs":"^3.0.7","jshint":"^2.9.5","lodash":"^4.17.10","mocha":"^8.3.0","nock":"^13.0.7","nyc":"^15.1.0","request":"^2.87.0","should":"^13.2.1","sinon":"^9.2.4"},"engines":{"node":">=10.0.0"},"scripts":{"cover":"nyc --reporter=lcov _mocha --recursive && open coverage/lcov-report/index.html","test":"jshint lib test && jscs lib test && nyc _mocha --recursive --check-leaks --globals Promise && nyc check-coverage --statements 100 --functions 100 --branches 100 --lines 100"},"repository":{"type":"git","url":"https://github.com/silas/node-papi.git"},"keywords":["api","client","http","rest"],"author":"Silas Sewell <silas@sewell.org>","license":"MIT","bugs":{"url":"https://github.com/silas/node-papi/issues"},"homepage":"https://github.com/silas/node-papi"}')},2357:e=>{"use strict";e.exports=require("assert")},6417:e=>{"use strict";e.exports=require("crypto")},8614:e=>{"use strict";e.exports=require("events")},5747:e=>{"use strict";e.exports=require("fs")},8605:e=>{"use strict";e.exports=require("http")},7211:e=>{"use strict";e.exports=require("https")},1631:e=>{"use strict";e.exports=require("net")},2087:e=>{"use strict";e.exports=require("os")},5622:e=>{"use strict";e.exports=require("path")},1191:e=>{"use strict";e.exports=require("querystring")},4016:e=>{"use strict";e.exports=require("tls")},1669:e=>{"use strict";e.exports=require("util")}};var t={};function __nccwpck_require__(r){var s=t[r];if(s!==undefined){return s.exports}var n=t[r]={exports:{}};var o=true;try{e[r].call(n.exports,n,n.exports,__nccwpck_require__);o=false}finally{if(o)delete t[r]}return n.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var r={};(()=>{const e=__nccwpck_require__(2186);const{run:t}=__nccwpck_require__(9139);t(e)})();module.exports=r})();